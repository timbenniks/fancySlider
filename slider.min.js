var Slider=function(a,b){this.options=$.extend({},this.defaults,b);this.container=$(a);this.init()};Slider.prototype={init:function(){this.track=$('<div class="slider-track" />');this.head=$('<div class="slider-head" />');this.glass=$('<div class="slider-glass" />');this.base=$('<div class="slider-base" />').append(this.track,this.head,this.glass);this.container.after(this.base).hide();this.headWidth=this.head.width();this.width=this.base.width();this.maxHeadX=this.width-this.headWidth+1;this.doc=$(document);this.assignListeners();setTimeout($.proxy(function(){this.position(this.options.startPos);this.container.val(this.options.startPos)},this),0)},assignListeners:function(){this.glass.on("mousedown touchmove",$.proxy(function(c){c.preventDefault();var d=this.getRelPos(this.glass[0],c),b=this.headWidth/2,a=this.positionInt();if(d.x>=a&&d.x<a+this.headWidth){b=d.x-a}this.positionInt(d.x-b);this.doc.on({mousemove:$.proxy(function(f){f.preventDefault();var g=this.getRelPos(this.glass[0],f);this.positionInt(g.x-b)},this),mouseup:$.proxy(function(){this.doc.off("mousemove mouseup")},this)})},this));this.container.on({slideTo:$.proxy(function(a){this.position(a.position)},this),slide:$.proxy(function(a){this.container.val(a.position)},this),change:$.proxy(function(a){this.position($(a.currentTarget).val())},this)})},positionInt:function(b){if(!b){return this.getPos(this.head[0]).x-this.getPos(this.base[0]).x}else{var a=Math.round(this.cap(b,0,this.maxHeadX))+"px";this.head.css({left:a})}this.container.trigger({type:"slide",position:this.lerp(0,0,this.maxHeadX,1,(this.getPos(this.head[0]).x-this.getPos(this.base[0]).x))})},position:function(a){this.positionInt(this.lerp(0,0,1,this.maxHeadX,a))},cap:function(b,a,c){if(b<a){return a}if(b>c){return c}return b},lerp:function(d,a,c,e,b){return(b-d)*(e-a)/(c-d)+a},getPos:function(b){var a=0,c=0;while(b!==null){a+=b.offsetLeft;c+=b.offsetTop;b=b.offsetParent}return{x:a,y:a}},getRelPos:function(c,a){var b=this.getPos(c);return{x:a.pageX-b.x,y:a.pageY-b.y}},defaults:{startPos:0}};$.fn.slider=function(a){return this.each(function(){var c=$.extend({},a,$(this).data("options")),b=$.data(this,"slider")||$.data(this,"slider",new Slider(this,c))})};
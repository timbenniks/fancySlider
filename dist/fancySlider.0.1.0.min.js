/*!
*	@Class:			fancySlider
*	@Version:		0.1.0
*	@Created on:	2012-07-21
*	@Description:	A simple range input polyfill
*	@Author:		Tim Benniks
*	@Licence:		MIT
*	@Project page:	http://fancyslider.timbenniks.nl
 ---------------------------------------------------------------------------- */
(function(a){var b=function(b,c){this.options=a.extend({},this.defaults,c),this.container=a(b),this.init()};b.prototype={init:function(){this.track=a('<div class="slider-track" />'),this.head=a('<div class="slider-head" />'),this.glass=a('<div class="slider-glass" />'),this.base=a('<div class="slider-base" />').append(this.track,this.head,this.glass).addClass(this.container[0].className),this.container.after(this.base).hide(),this.headWidth=this.head.width(),this.width=this.base.width(),this.maxHeadX=this.width-this.headWidth+1,this.doc=a(document),this.assignListeners(),setTimeout(a.proxy(function(){this.position(this.options.startPos),this.container.val(this.options.startPos)},this),0)},assignListeners:function(){this.glass.on("mousedown touchmove",a.proxy(function(b){b.preventDefault();var c=this.getRelPos(this.glass[0],b),d=this.headWidth/2,e=this.positionInt();c.x>=e&&c.x<e+this.headWidth&&(d=c.x-e),this.positionInt(c.x-d),this.container.trigger({type:"slideStart",position:this.lerp(0,0,this.maxHeadX,1,this.getPos(this.head[0]).x-this.getPos(this.base[0]).x)}),this.doc.on({mousemove:a.proxy(function(a){a.preventDefault();var b=this.getRelPos(this.glass[0],a);this.positionInt(b.x-d)},this),mouseup:a.proxy(function(){this.doc.off("mousemove mouseup"),this.container.trigger({type:"slideEnd",position:this.lerp(0,0,this.maxHeadX,1,this.getPos(this.head[0]).x-this.getPos(this.base[0]).x)})},this)})},this)),this.container.on({slideTo:a.proxy(function(a){this.position(a.position)},this),slide:a.proxy(function(a){this.container.val(a.position)},this),change:a.proxy(function(b){this.position(a(b.currentTarget).val())},this)})},positionInt:function(a){if(!a)return this.getPos(this.head[0]).x-this.getPos(this.base[0]).x;var b=Math.round(this.cap(a,0,this.maxHeadX))+"px";this.head.css({left:b}),this.container.trigger({type:"slide",position:this.lerp(0,0,this.maxHeadX,1,this.getPos(this.head[0]).x-this.getPos(this.base[0]).x)})},position:function(a){this.positionInt(this.lerp(0,0,1,this.maxHeadX,a))},cap:function(a,b,c){return a<b?b:a>c?c:a},lerp:function(a,b,c,d,e){return(e-a)*(d-b)/(c-a)+b},getPos:function(a){var b=0,c=0;while(a!==null)b+=a.offsetLeft,c+=a.offsetTop,a=a.offsetParent;return{x:b,y:b}},getRelPos:function(a,b){var c=this.getPos(a);return{x:b.pageX-c.x,y:b.pageY-c.y}},defaults:{startPos:0}},a.fn.fancySlider=function(c){return this.each(function(){var d=a.extend({},c,a(this).data("options")),e=a.data(this,"fancySlider")||a.data(this,"fancySlider",new b(this,d))})}})(jQuery);